<!DOCTYPE html>
<!-- O idioma da tag <html> ser√° definido dinamicamente pelo JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sele√ß√£o de Idioma</title>
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define a fonte Inter como padr√£o (similar ao Inter) */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Adiciona uma transi√ß√£o suave para o modo escuro */
        body, .bg-white, .bg-gray-800 {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        /* Fallback para a fonte Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
    </style>
    <script>
        // Configura√ß√£o do Tailwind para modo escuro
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        // Paleta prim√°ria roxa aprimorada
                        'primary-purple': {
                            500: '#9b59b6',
                            600: '#8e44ad',
                        }
                    }
                },
            },
        }
    </script>
</head>
<!-- O oncontextmenu previne o menu de contexto padr√£o do navegador -->
<body class="bg-gradient-to-br from-indigo-200 to-purple-300 dark:from-gray-900 dark:to-indigo-900" oncontextmenu="return false;">

    <!--
      L√ìGICA DE REDIRECIONAMENTO AUTOM√ÅTICO
      Isso precisa ser verificado antes de renderizar a p√°gina.
    -->
    <script>
        const LANG_KEY = 'preferredLanguage';
        const savedLang = localStorage.getItem(LANG_KEY);

        // Mapeamento de idioma para o arquivo de destino
        const langToFileMap = {
            'pt-br': 'index-portuguese.html',
            'en': 'index-english.html',
            'es': 'index-spanish.html',
            'fr': 'index-french.html',
            'de': 'index-german.html',
            'ru': 'index-russian.html'
        };

        // Se um idioma j√° foi salvo, redireciona automaticamente para o arquivo espec√≠fico
        if (savedLang) {
            const targetFile = langToFileMap[savedLang] || 'index-english.html';
            // Usamos 'replace' para que o usu√°rio n√£o possa "voltar" para a tela de sele√ß√£o
            window.location.replace(targetFile);
        }
    </script>

    <!-- TRANSITION OVERLAY: Aparece para dar o efeito de transi√ß√£o no redirecionamento -->
    <div id="transition-overlay" class="fixed inset-0 bg-gray-900/90 dark:bg-black/90 opacity-0 transition-opacity duration-500 pointer-events-none z-50 flex flex-col items-center justify-center text-white text-2xl font-semibold">
        <div class="animate-pulse flex items-center space-x-3">
            <span class="text-4xl">‚ú®</span>
            <span data-translate-key="redirecting">Starting the Game</span>
        </div>
    </div>

    <!-- Container Principal -->
    <div id="main-content" class="flex flex-col items-center justify-center min-h-screen p-4 transition-opacity duration-500">
        
        <!-- Bot√£o de Modo Claro/Escuro -->
        <button id="theme-toggle" type="button" class="absolute top-5 right-5 text-gray-700 dark:text-gray-300 bg-white/50 dark:bg-gray-700/50 hover:bg-white dark:hover:bg-gray-700 backdrop-blur-sm rounded-full p-3 shadow-lg transition-colors duration-300">
            <!-- √çcone de Lua (Modo Escuro) -->
            <svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
            <!-- √çcone de Sol (Modo Claro) -->
            <svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M12 1.5a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V2.25A.75.75 0 0112 1.5zM12 18a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0112 18zM6.34 7.23a.75.75 0 011.06-.01l1.06-1.06a.75.75 0 010-1.06.75.75 0 011.06 0l1.06 1.06a.75.75 0 01-.01 1.06zM15.54 16.77a.75.75 0 011.06 0l1.06 1.06a.75.75 0 010 1.06.75.75 0 01-1.06 0l-1.06-1.06a.75.75 0 010-1.06zM12 6a6 6 0 100 12 6 6 0 000-12zM21.75 12a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5a.75.75 0 01.75.75zM3 12a.75.75 0 01.75.75H5.25a.75.75 0 010-1.5H3.75A.75.75 0 013 12zM7.23 15.54a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06 0 .75.75 0 010-1.06l1.06-1.06a.75.75 0 011.06 0zM16.77 7.23a.75.75 0 010 1.06l1.06 1.06a.75.75 0 010 1.06.75.75 0 01-1.06 0l-1.06-1.06a.75.75 0 010-1.06z" clip-rule="evenodd" />
            </svg>
        </button>

        <!-- Card de Sele√ß√£o (Glassmorphism Aprimorado) -->
        <div class="w-full max-w-md bg-white/30 dark:bg-gray-800/50 backdrop-blur-xl border border-white/10 dark:border-gray-700 shadow-2xl rounded-2xl p-8">
            <!-- √çcone de Chef (Emoji) -->
            <div class="flex justify-center mb-4">
                <span class="text-6xl">üßë‚Äçüç≥</span> 
            </div>
            <!-- CONTE√öDO PADR√ÉO ALTERADO PARA INGL√äS -->
            <h1 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-4" data-translate-key="title">
                Choose Your Language
            </h1>
            <p class="text-center text-gray-700 dark:text-gray-300 mb-8 font-light" data-translate-key="subtitle">
                Your choice will be saved for your next visit.
            </p>

            <!-- Lista de Idiomas -->
            <div class="space-y-4">
                <!-- Alterado onclick para passar o evento (event) -->
                <a href="index-portuguese.html" class="block w-full" onclick="handleLanguageClick(event, 'pt-br')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-pt-br">
                        <span>üáßüá∑</span> <span>Portugu√™s (Brasil)</span>
                    </div>
                </a>
                
                <a href="index-english.html" class="block w-full" onclick="handleLanguageClick(event, 'en')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-en">
                        <span>üá¨üáß</span> <span>English</span>
                    </div>
                </a>

                <a href="index-spanish.html" class="block w-full" onclick="handleLanguageClick(event, 'es')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-es">
                        <span>üá™üá∏</span> <span>Espa√±ol</span>
                    </div>
                </a>

                <a href="index-french.html" class="block w-full" onclick="handleLanguageClick(event, 'fr')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-fr">
                        <span>üá´üá∑</span> <span>Fran√ßais</span>
                    </div>
                </a>

                <a href="index-german.html" class="block w-full" onclick="handleLanguageClick(event, 'de')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-de">
                        <span>üá©üá™</span> <span>Deutsch</span>
                    </div>
                </a>

                <a href="index-russian.html" class="block w-full" onclick="handleLanguageClick(event, 'ru')">
                    <div class="flex items-center justify-center space-x-3 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-gray-200 font-medium text-lg transition-all duration-300 shadow-md hover:bg-primary-purple-500 hover:text-white dark:hover:bg-primary-purple-600 hover:shadow-xl hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-primary-purple-500/50 dark:focus:ring-primary-purple-600/50 focus:ring-offset-2 dark:focus:ring-offset-gray-900" data-translate-key="lang-ru">
                        <span>üá∑üá∫</span> <span>–†—É—Å—Å–∫–∏–π</span>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <script>
        // --- GERENCIAMENTO DE IDIOMA E TRADU√á√ÉO ---

        // Dicion√°rio de tradu√ß√µes para a p√°gina de sele√ß√£o
        const translations = {
            'en': {
                'title': 'Choose Your Language',
                'subtitle': 'Your choice will be saved for your next visit.',
                'redirecting': 'Starting the Game', // Alterado para Starting the Game
                'lang-pt-br': 'Portugu√™s (Brasil)',
                'lang-en': 'English',
                'lang-es': 'Espa√±ol',
                'lang-fr': 'Fran√ßais',
                'lang-de': 'Deutsch',
                'lang-ru': '–†—É—Å—Å–∫–∏–π'
            },
            'pt-br': {
                'title': 'Escolha Seu Idioma',
                'subtitle': 'Sua escolha ser√° salva para a pr√≥xima visita.',
                'redirecting': 'Iniciando o Jogo', // Tradu√ß√£o para Portugu√™s
                'lang-pt-br': 'Portugu√™s (Brasil)',
                'lang-en': 'Ingl√™s',
                'lang-es': 'Espanhol',
                'lang-fr': 'Franc√™s',
                'lang-de': 'Alem√£o',
                'lang-ru': 'Russo'
            },
            'es': {
                'title': 'Elige Tu Idioma',
                'subtitle': 'Tu elecci√≥n se guardar√° para tu pr√≥xima visita.',
                'redirecting': 'Iniciando el Juego', // Tradu√ß√£o para Espanhol
                'lang-pt-br': 'Portugu√™s (Brasil)',
                'lang-en': 'Ingl√©s',
                'lang-es': 'Espa√±ol',
                'lang-fr': 'Franc√©s',
                'lang-de': 'Alem√°n',
                'lang-ru': 'Ruso'
            },
            'fr': {
                'title': 'Choisissez Votre Langue',
                'subtitle': 'Votre choix sera sauvegard√© pour votre prochaine visite.',
                'redirecting': 'D√©marrage du Jeu', // Tradu√ß√£o para Franc√™s
                'lang-pt-br': 'Portugu√™s (Br√©sil)',
                'lang-en': 'Anglais',
                'lang-es': 'Espagnol',
                'lang-fr': 'Fran√ßais',
                'lang-de': 'Allemand',
                'lang-ru': 'Russe'
            },
            'de': {
                'title': 'W√§hle deine Sprache',
                'subtitle': 'Ihre Auswahl wird f√ºr Ihren n√§chsten Besuch gespeichert.',
                'redirecting': 'Starte das Spiel', // Tradu√ß√£o para Alem√£o
                'lang-pt-br': 'Portugiesisch (Brasilien)',
                'lang-en': 'Englisch',
                'lang-es': 'Spanisch',
                'lang-fr': 'Franz√∂sisch',
                'lang-de': 'Deutsch',
                'lang-ru': 'Russisch'
            },
            'ru': {
                'title': '–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —è–∑—ã–∫',
                'subtitle': '–í–∞—à –≤—ã–±–æ—Ä –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–∑–∏—Ç–∞.',
                'redirecting': '–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã', // Tradu√ß√£o para Russo
                'lang-pt-br': '–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π (–ë—Ä–∞–∑–∏–ª–∏—è)',
                'lang-en': '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π',
                'lang-es': '–ò—Å–ø–∞–Ω—Å–∫–∏–π',
                'lang-fr': '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π',
                'lang-de': '–ù–µ–º–µ—Ü–∫–∏–π',
                'lang-ru': '–†—É—Å—Å–∫–∏–π'
            }
        };

        /**
         * Fun√ß√£o chamada ao clicar em um idioma.
         * Agora ela usa o 'href' do elemento clicado para o redirecionamento.
         * @param {Event} event O evento de clique.
         * @param {string} lang O c√≥digo do idioma.
         */
        function handleLanguageClick(event, lang) {
            event.preventDefault(); // Previne o redirecionamento imediato

            // Obt√©m o URL de destino do atributo href do link
            const targetUrl = event.currentTarget.getAttribute('href');

            const overlay = document.getElementById('transition-overlay');
            const mainContent = document.getElementById('main-content');

            // 1. Inicia a transi√ß√£o (fade out do conte√∫do, fade in do overlay)
            mainContent.style.opacity = '0';
            overlay.style.opacity = '1';
            overlay.classList.remove('pointer-events-none');
            
            // Traduz a mensagem de redirecionamento no overlay antes de mostrar
            const currentLang = document.documentElement.lang;
            const redirectMessageEl = overlay.querySelector('[data-translate-key="redirecting"]');
            if (redirectMessageEl) {
                // Certifica-se de que a mensagem √© traduzida corretamente
                redirectMessageEl.textContent = translations[currentLang]?.redirecting || translations['en'].redirecting;
            }


            // 2. Salva a escolha e redireciona ap√≥s a dura√ß√£o da transi√ß√£o
            setTimeout(() => {
                localStorage.setItem(LANG_KEY, lang);
                // Redireciona para o arquivo de destino espec√≠fico
                window.location.href = targetUrl;
            }, 500); // Espera 500ms (a dura√ß√£o do transition-opacity)
        }

        // Fun√ß√£o para traduzir a p√°gina com base no idioma
        function translatePage(lang) {
            // Pega as strings do idioma, ou usa 'en' como padr√£o
            const langStrings = translations[lang] || translations['en'];
            
            // Atualiza o atributo 'lang' da tag <html>
            document.documentElement.lang = lang;

            // Encontra todos os elementos com a chave de tradu√ß√£o
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                if (langStrings[key]) {
                    // Mant√©m os emojis no lugar, alterando apenas o texto
                    if (el.children.length > 0 && el.children[0].tagName === 'SPAN') {
                        // Isso √© para os bot√µes de idioma
                        el.children[1].textContent = langStrings[key];
                    } else {
                        // Isso √© para o t√≠tulo e subt√≠tulo
                        el.textContent = langStrings[key];
                    }
                }
            });
        }

        // Fun√ß√£o para detectar o idioma do navegador e aplicar a tradu√ß√£o
        function detectAndSetLanguage() {
            // Pega o idioma do navegador (ex: "en-US", "pt-BR", "es-ES")
            const browserLang = (navigator.language || 'en').toLowerCase();
            let lang = 'en'; // Padr√£o

            // Mapeamento de idiomas suportados
            if (browserLang.startsWith('pt')) {
                lang = 'pt-br';
            } else if (browserLang.startsWith('es')) {
                lang = 'es';
            } else if (browserLang.startsWith('fr')) {
                lang = 'fr';
            } else if (browserLang.startsWith('de')) {
                lang = 'de';
            } else if (browserLang.startsWith('ru')) {
                lang = 'ru';
            } else if (browserLang.startsWith('en')) {
                lang = 'en';
            }
            // Se n√£o for nenhum desses, o padr√£o 'en' ser√° usado

            translatePage(lang);
        }

        // --- GERENCIAMENTO DO MODO CLARO/ESCURO ---
        
        const themeToggleBtn = document.getElementById('theme-toggle');
        const darkIcon = document.getElementById('theme-toggle-dark-icon');
        const lightIcon = document.getElementById('theme-toggle-light-icon');

        // Fun√ß√£o para inicializar o modo escuro
        function initDarkMode() {
            const theme = localStorage.getItem('theme');
            // Prioriza a escolha do usu√°rio, se n√£o houver, usa a prefer√™ncia do dispositivo
            if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
                darkIcon.classList.remove('hidden');
                lightIcon.classList.add('hidden');
            } else {
                document.documentElement.classList.remove('dark');
                darkIcon.classList.add('hidden');
                lightIcon.classList.remove('hidden');
            }
        }

        // Fun√ß√£o para alternar o modo
        function toggleDarkMode() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            darkIcon.classList.toggle('hidden', !isDark);
            lightIcon.classList.toggle('hidden', isDark);
        }

        // Adiciona o listener ao bot√£o de altern√¢ncia
        themeToggleBtn.addEventListener('click', toggleDarkMode);

        // --- INICIALIZA√á√ÉO DA P√ÅGINA ---
        
        // Espera o DOM carregar para rodar os scripts de inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            // (A l√≥gica de redirecionamento j√° rodou l√° em cima)
            
            // Se n√£o fomos redirecionados, inicializa a p√°gina de sele√ß√£o:
            initDarkMode();
            detectAndSetLanguage();
        });

        // Adiciona um listener extra para desabilitar o clique direito em todo o documento
        document.addEventListener('contextmenu', event => event.preventDefault());

    </script>
</body>
</html>
