<!doctype html>
<html lang="pt-BR" class="light">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6A0DAD">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Siga a Receita!</title>

  <!-- Tailwind config + CDN -->
  <script>
    tailwind = { config: { darkMode: 'class' } };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- Tone.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

  <meta name="description" content="🍳 Siga a Receita é um jogo onde cada segundo conta! Prepare pratos deliciosos para seus clientes o mais rápido possível — mas cuidado, o tempo não está do seu lado! Será que você consegue acompanhar o ritmo da cozinha e se tornar o chef mais ágil de todos?" />

  <!-- Manifest PWA -->
  <link rel="manifest" href="/manifest.webmanifest">

  <!-- Ícones PWA -->
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">

<!-- PWA Manifest - Updated with provided icon. For production, convert to Data URL with multiple sizes. -->
<link rel="manifest" href="/manifest.webmanifest">


  <!-- Cor do tema (roxo) -->
  <meta name="theme-color" content="#6A0DAD">

  <!-- Suporte para instalação no iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">

  <style>
    /* THEME VARIABLES (expanded ~3x) */
    :root{
      /* Light Theme VIBRANT */
      --bg-grad:linear-gradient(135deg,#ffffff 0%,#e0f2ff 100%); /* clean white to blue */
      --glass:rgba(255,255,255,.9);
      --panel-bg:rgba(255,255,255,.98);
      --panel-border:rgba(0,0,0,0.1);
      --text-primary:#0f172a;
      --text-secondary:#334155;
      --accent:#8b5cf6; /* Indigo/Purple */
      --accent-2:#10b981; /* Emerald */
      --danger:#ef4444; /* Red */
      --success:#22c55e; /* Green */
      --muted:#f1f5f9; /* Slate 100 */
      --muted-2:#e2e8f0; /* Slate 200 */
      --ring:#a78bfa;
      --shadow:0 12px 25px rgba(0,0,0,0.15);
      --bubble-bg:#ffffff;
      --bubble-border:#d1d5db;
      --timer-grad:linear-gradient(90deg,#ef4444,#fb923c);
      --modal-scrim:rgba(0,0,0,0.8);
      --img-size:1.3em;
    }
    html.dark{
      /* Dark Theme VIBRANT */
      --bg-grad:linear-gradient(135deg,#0c0a09 0%,#1c1917 50%,#3b0764 100%); /* dark with subtle purple */
      --glass:rgba(25,30,45,.75);
      --panel-bg:rgba(20,20,25,.9);
      --panel-border:rgba(255,255,255,0.1);
      --text-primary:#f8fafc;
      --text-secondary:#cbd5e1;
      --accent:#a78bfa; /* Violet */
      --accent-2:#34d399; /* Emerald */
      --danger:#fca5a5; /* Red */
      --success:#4ade80; /* Green */
      --muted:#27272a; /* Zinc 800 */
      --muted-2:#3f3f46; /* Zinc 700 */
      --ring:#c4b5fd;
      --shadow:0 12px 30px rgba(0,0,0,0.6);
      --bubble-bg:#1f2937;
      --bubble-border:#374151;
      --timer-grad:linear-gradient(90deg,#f43f5e,#f59e0b);
      --modal-scrim:rgba(0,0,0,0.9);
    }

    html,body,#app{height:100%}
    body{
      font-family:"Noto Sans",Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:var(--bg-grad);
      margin:0; overflow:hidden;
      color:var(--text-primary);
      transition:background .5s ease, color .3s ease; /* Increased transition time */
    }
    .no-select{user-select:none;-webkit-user-select:none}

    /* MOBILE-FOCUSED CONTAINER OVERRIDES */
    #game-container{
      background:var(--panel-bg)!important;
      border:1px solid var(--panel-border)!important;
      box-shadow:var(--shadow);
      animation:containerPop .4s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; /* Bouncy entry */
    }
    @keyframes containerPop{from{transform:translateY(20px) scale(.95); opacity:0}to{transform:translateY(0) scale(1); opacity:1}}

    /* Screen entry animation */
    .screen-enter{ animation:screenFade .4s ease-out both } /* Slower/smoother transition */
    @keyframes screenFade{ from{ opacity:0; transform:translateY(10px) } to{ opacity:1; transform:translateY(0) } }

    .screen{
      color:var(--text-primary);
    }
    header, footer{
      background:var(--panel-bg)!important;
      border-color:var(--panel-border)!important;
      color:var(--text-primary)!important;
      transition:background .3s ease, color .2s ease, border-color .3s ease;
    }

    /* Buttons */
    .btn-main{
      transform:translateZ(0);
      transition:transform .15s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow .2s ease, background .2s ease, color .2s ease, border-color .2s ease, opacity .15s ease;
      will-change:transform, box-shadow;
      border:1px solid transparent;
      box-shadow:0 6px 15px rgba(0,0,0,0.12); /* Increased shadow */
    }
    .btn-main:hover{ transform:scale(1.03) }
    .btn-main:active{ transform:scale(.95); box-shadow:0 3px 8px rgba(0,0,0,0.1) }
    .btn-theme{
      background:var(--muted)!important;
      color:var(--text-primary)!important;
      border:1px solid var(--panel-border)!important;
      transition:background .2s ease,color .2s ease,border-color .2s ease, transform .1s ease;
    }
    .btn-theme:active { transform: scale(0.9) }

    /* Speech bubble */
    .speech-bubble{
      background:var(--bubble-bg)!important;
      border:1px solid var(--bubble-border)!important;
      border-radius:20px; /* Softer edges */
      padding:1rem;
      position:relative;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      transition:transform .15s ease;
    }
    .speech-bubble:hover{ transform:translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.1) }

    /* Timer bar - add slight elevation */
    #timer-bar-inner{
      background:var(--timer-grad)!important;
      box-shadow:0 2px 5px rgba(0,0,0,0.2);
    }

    /* Modals */
    #market-message-modal,
    #confirm-reset-modal,
    #rank-up-modal,
    #pause-modal{
      background:var(--modal-scrim)!important;
      backdrop-filter:blur(4px);
      animation:fadeIn .2s ease both;
    }
    @keyframes fadeIn{ from{ opacity:0 } to{ opacity:1 } }

    #market-message-content,
    #rank-up-modal .bg-white,
    #confirm-reset-modal .bg-white,
    #pause-modal .card{
      background:var(--panel-bg)!important;
      color:var(--text-primary)!important;
      border:1px solid var(--panel-border)!important;
      animation:modalPop .3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
    }
    @keyframes modalPop{ from{ transform:scale(0.8); opacity:0 } to{ transform:scale(1); opacity:1 } }
    
    /* Success/Failure Modal Animation */
    #success-modal, #failure-modal {
      animation: slideInUp .4s cubic-bezier(0.175, 0.885, 0.32, 1.275) both, fadeOut .3s 1s ease forwards;
      opacity: 0;
      position: absolute;
      flex-direction: column;
    }
    @keyframes slideInUp {
      0% { transform: translateY(100%); opacity: 0; }
      50% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(0); opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    /* GLOBAL TRANSITION SUPPORT - subtle hardware-accelerated motion */
    .soft-transition { transition: transform .25s cubic-bezier(.2,.9,.2,1), opacity .22s ease, box-shadow .22s ease, background .22s ease; will-change: transform, opacity, box-shadow; }

    /* Modal scrim improvements */
    .modal-scrim-pane { background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.75)); backdrop-filter: blur(6px); }
    html.light .modal-scrim-pane { background: linear-gradient(180deg, rgba(255,255,255,0.65), rgba(255,255,255,0.85)); }

    /* Modal card improved (theme aware) */
    .modal-card {
      border-radius: 1rem;
      padding: 1.1rem;
      box-shadow: 0 22px 60px rgba(2,6,23,0.18);
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      color: var(--text-primary);
      transform-origin: center center;
      animation: modalElevate .34s cubic-bezier(.2,.9,.2,1) both;
    }

    /* Restaurants modal header pill */
    #restaurants-modal .card .resto-header {
      display:flex; align-items:center; gap:.8rem; padding:.6rem; border-radius:.8rem; margin-bottom:.6rem;
      background: linear-gradient(90deg, rgba(139,92,246,0.12), rgba(59,130,246,0.06));
      border:1px solid rgba(167,139,250,0.08);
    }

    /* Improved restaurant entry with theme aware accent */
    #restaurants-list .resto-entry {
      display:flex; align-items:center; justify-content:space-between; gap:.8rem; padding:.65rem; border-radius:.75rem;
      background:var(--bubble-bg); border:1px solid var(--bubble-border);
      transition: transform .14s ease, box-shadow .14s ease;
    }
    #restaurants-list .resto-entry:hover{ transform: translateY(-4px); box-shadow: 0 10px 28px rgba(0,0,0,0.06); }

    /* Unified modal fade in/out */
    .modal-wrap { opacity:0; pointer-events:none; transition:opacity .28s ease; }
    .modal-wrap.show { opacity:1; pointer-events:auto; }
    .modal-card.fade { transform-origin:center; transform:translateY(8px) scale(.995); transition:transform .28s cubic-bezier(.2,.9,.2,1), opacity .28s ease; }
    .modal-wrap.show .modal-card.fade { transform:translateY(0) scale(1); opacity:1; }

    /* Polished modal content */
    .modal-card {
      border-radius: 1rem;
      padding: 1.1rem;
      box-shadow: 0 18px 40px rgba(2,6,23,0.14);
      transform-origin: center center;
      animation: modalElevate .34s cubic-bezier(.2,.9,.2,1) both;
    }
    @keyframes modalElevate { from{ transform: translateY(10px) scale(.98); opacity:0 } to{ transform: translateY(0) scale(1); opacity:1 } }

    /* Upcoming ranks modal specific styling */
    #upcoming-ranks-modal .card {
      max-width: 420px;
      width: 100%;
      padding: 1rem;
      border-radius: 14px;
      box-shadow: 0 16px 36px rgba(2,6,23,0.12);
    }
    #upcoming-ranks-list .rank-entry{
      display:flex; align-items:center; justify-content:space-between;
      gap:.75rem; padding:.7rem; border-radius:.75rem; background:var(--bubble-bg); border:1px solid var(--bubble-border);
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
    }
    #upcoming-ranks-list .rank-entry:hover{ transform: translateY(-4px); box-shadow: 0 10px 28px rgba(0,0,0,0.08); }
    #upcoming-ranks-list .rank-icon{ font-size:1.6rem; margin-right:.5rem; }
    #upcoming-ranks-list .rank-meta{ color:var(--text-secondary); font-size:0.95rem; }

    /* "Ver próximos ranques" button polish + dark-mode safe */
    #view-upcoming-ranks{
      background:var(--muted-2);
      color:var(--text-primary);
      border:1px solid var(--panel-border);
      padding:.5rem .75rem;
      border-radius:.75rem;
      font-weight:700;
      box-shadow: 0 6px 18px rgba(2,6,23,0.06);
      transition: transform .14s ease, background .18s ease, color .12s ease;
    }
    #view-upcoming-ranks:hover{ transform: translateY(-2px); }
    html.dark #view-upcoming-ranks{
      background: rgba(255,255,255,0.04);
      color: var(--text-secondary);
      border-color: rgba(255,255,255,0.06);
      box-shadow: 0 8px 22px rgba(0,0,0,0.45);
    }

    /* Modal buttons - unify style */
    .modal-actions .btn-main { min-width:100px; }
    .modal-actions .btn-ghost { background:transparent; border:1px solid var(--panel-border); color:var(--text-primary); }

    /* Accessibility improvement: focus visible state inside modals */
    #upcoming-ranks-modal :focus-visible, #market-message-modal :focus-visible, #rank-up-modal :focus-visible { outline: none; box-shadow: 0 0 0 6px rgba(167,139,250,0.15); border-radius: .65rem; }

    /* Small animated badges */
    .meta-badge{ background:var(--accent); color:white; padding:.25rem .5rem; border-radius:999px; font-weight:700; font-size:.8rem; box-shadow:0 6px 18px rgba(139,92,246,0.14); transform:translateZ(0); }

    /* Ingredient btn */
    .ingredient-btn{
      background:var(--bubble-bg)!important;
      border:1px solid var(--bubble-border)!important;
      transition:transform .1s ease, box-shadow .2s ease, opacity .12s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .ingredient-btn:hover{ transform:scale(1.08); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .ingredient-btn:active{ transform:scale(.95) }

    /* Recipe steps */
    .recipe-step{ 
      display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .65rem; background:var(--muted-2); 
      border-radius:.75rem; margin:.2rem; border:1px solid var(--panel-border); 
      transition:background .2s ease, transform .2s ease; 
      font-size: 1.1em; /* slightly larger */
    }
    .recipe-step.correct{ 
      outline:3px solid var(--success); 
      background: rgba(34, 197, 94, 0.1);
      box-shadow:0 0 0 4px rgba(34, 197, 94,.2); 
      animation: stepSuccess .3s ease;
    }
    @keyframes stepSuccess {
        0% { transform: scale(0.9); opacity: 0.5; }
        100% { transform: scale(1); opacity: 1; }
    }

    /* Consistent emoji & image sizing */
    .ing-img{ width:var(--img-size); height:var(--img-size); object-fit:contain; display:inline-block; vertical-align:middle; }

    /* Market tabs */
    .tabbar{ display:flex; gap:.5rem; padding:.25rem; background:var(--bubble-bg); border:1px solid var(--bubble-border); border-radius:1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .tab{ flex:1; text-align:center; padding:.6rem .8rem; border-radius:.75rem; font-weight:700; border:1px solid transparent; transition:background .2s ease, color .2s ease, border-color .2s ease, transform .12s ease; }
    .tab:hover{ transform:scale(1.01) }
    .tab.active{ 
      background:var(--accent); 
      color:white; 
      border-color:var(--accent); 
      box-shadow: 0 4px 10px rgba(139, 92, 246, 0.3); 
      transform:scale(1.02);
    }

    /* Money pill */
    .money-pill{ background:var(--accent-2)!important; color:#fff!important; transition:transform .15s ease, box-shadow .2s ease; }
    .money-pill:hover{ transform:scale(1.05) }
    .money-pill.scale-110{ transform:scale(1.15); box-shadow: 0 6px 15px rgba(0,0,0,0.2); } /* Enhanced pop animation */

    /* Stars pill (purple to match theme; same size as money) */
    .stars-pill{ background:var(--accent) !important; color:#fff !important; font-weight:700; transition:transform .15s ease, box-shadow .2s ease; display:inline-flex; align-items:center; gap:.4rem; padding:.45rem .7rem; border-radius:999px; }

    /* NPC emoji size and subtle hover */
    #npc-display{ 
      font-size: 8rem; /* Larger NPC */
      filter:drop-shadow(0 10px 15px rgba(0,0,0,.2)); 
      transition:transform .2s ease; 
    }
    #npc-display:hover{ transform:scale(1.05) rotate(-1deg); }

    /* Rush hour banner */
    #rush-hour-banner{ 
      background: linear-gradient(90deg, #f97316, #ef4444); /* Orange to Red gradient */
      box-shadow: 0 0 10px #f97316;
      animation: bannerSlideDown .5s cubic-bezier(0.68, -0.55, 0.265, 1.55) both 0.1s, bannerPulse 1.5s ease 0.6s infinite alternate; 
      font-size: 1.1em;
    }
    @keyframes bannerSlideDown { from { transform: translateY(-100%); } to { transform: translateY(0); } }
    @keyframes bannerPulse{ 
      0%{ opacity:.8; box-shadow: 0 0 8px rgba(249, 115, 22, 0.8) } 
      100%{ opacity:1; box-shadow: 0 0 15px rgba(249, 115, 22, 1.0) } 
    }

    /* Accessibility focus rings */
    :focus-visible{ outline:none; box-shadow:0 0 0 4px var(--ring) inset, 0 0 0 4px var(--ring); border-radius:.75rem; }

    /* Utility animations */
    .animate-chef-wave{ animation:chefWave 1.2s ease infinite }
    @keyframes chefWave{ 0%{ transform:rotate(0deg) } 50%{ transform:rotate(8deg) } 100%{ transform:rotate(0deg) } }

    /* Enhanced modal visuals for upcoming ranks and restaurants */
    #upcoming-ranks-modal .modal-card {
      /* Use theme-aware panel background so dark/light modes are consistent */
      background: var(--panel-bg);
      border-radius: 16px;
      padding: 0;
      overflow: hidden;
      box-shadow: 0 22px 60px rgba(2,6,23,0.18);
    }
    #upcoming-ranks-modal .modal-card .p-4 {
      padding: 1rem 1.2rem;
    }
    #upcoming-ranks-list .rank-entry {
      background: var(--bubble-bg);
      border: 1px solid var(--bubble-border);
      padding: .75rem .9rem;
      gap:.75rem;
    }
    #upcoming-ranks-list .rank-entry .rank-icon { font-size:1.8rem; margin-right:.6rem; transform:translateY(2px); }
    #upcoming-ranks-list .rank-meta { color:var(--text-secondary); font-size:0.95rem; }

    /* Restaurants modal */
    #restaurants-modal .card {
      border-radius: 14px;
      padding: .9rem;
      max-width: 520px;
      width: 100%;
      /* Theme-aware panel bg for dark mode compatibility */
      background: var(--panel-bg);
      box-shadow: 0 28px 70px rgba(2,6,23,0.18);
      border: 1px solid var(--panel-border);
      color: var(--text-primary);
    }
    #restaurants-list .flex.items-center {
      padding: .6rem .7rem;
      border-radius: 10px;
      background: var(--bubble-bg);
      border: 1px solid var(--bubble-border);
    }
    #restaurants-list .switch-resto, #restaurants-list .delete-resto {
      padding:.45rem .6rem; font-weight:700; border-radius:8px;
    }
    #restaurants-list .delete-resto { background: linear-gradient(90deg,#fb7185,#ef4444); box-shadow:0 8px 20px rgba(239,68,68,0.12); }
    #restaurants-list .switch-resto { background: linear-gradient(90deg,#60a5fa,#3b82f6); box-shadow:0 8px 20px rgba(59,130,246,0.12); }

    /* Subtle typography polish for modal headers */
    #upcoming-ranks-title, #restaurants-modal h3 { font-weight:700; letter-spacing: -0.2px; }

    /* Streak display */
    #streak-display.animate-pulse {
        animation: streakPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
        color: #ff8c00; /* Deep orange */
        font-size: 1.2em;
        text-shadow: 0 0 5px rgba(255, 140, 0, 0.5);
    }
    @keyframes streakPop {
        0% { transform: scale(1.0); }
        50% { transform: scale(1.4); }
        100% { transform: scale(1.0); }
    }

    #loading-screen{
      background: var(--bg-grad);
      transition: opacity 0.5s ease;
      z-index: 9999;
    }
    .fade-out {
      opacity: 0 !important;
      pointer-events: none;
    }

    #market-items-grid, #market-owned-grid {
      /* fill almost entire available viewport height while leaving room for header/footer */
      height: 100%;
      overflow-y: auto;
      padding-right: 6px;
    }
    /* Make the market scroll area fill the remaining viewport height (header + footer reserved) */
    #market-scroll {
      display: block;
      height: calc(100vh - 140px); /* Adjust 140px to match header/footer total height */
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    /* Improve confirm reset modal visual in light mode */
    #confirm-reset-modal > div {
      background: var(--panel-bg) !important;
      border: 1px solid var(--panel-border) !important;
      box-shadow: var(--shadow);
      transition: transform .12s ease;
    }

    #rank-up-modal .p-5 {
      background:var(--panel-bg)!important;
      color:var(--text-primary)!important;
      border:1px solid var(--panel-border)!important;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      border-radius:1rem;
      padding:1.25rem;
      transition:transform .18s ease, box-shadow .18s ease;
    }

    #game-container{height:100%;max-height:100%;}
    /* Mobile-safe viewport height + safe areas */
    @media (max-width: 640px){
      #game-container{height:calc(100svh - env(safe-area-inset-top) - env(safe-area-inset-bottom)); width:100vw; border-radius:0;}
      body{padding-bottom:env(safe-area-inset-bottom);}
    }
    /* Market layout: no overlap, better scroll */
    #market-screen header{position:sticky;top:0;z-index:20}
    #market-screen main{overflow:hidden;display:flex;flex-direction:column;}
    #market-scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;max-height:none}
    /* Expand scroll containers to bottom on mobile for both tabs */
    #market-items-grid, #market-owned-grid {
      padding-right: 6px;
      /* ensure market grids can expand to fill the market-scroll area */
      min-height: calc(100vh - 240px);
    }
    /* Ensure market scroll region fills available space and internal grids scroll */
    #market-screen main > .tabbar { position: sticky; top: 0; z-index: 25; }
    #market-scroll {
      display: flex;
      flex-direction: column;
      height: calc(100vh - 140px); /* leave room for header/footer */
      overflow: hidden;
    }
    #market-items-grid, #market-owned-grid {
      flex: 1 1 auto;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      padding-right: 8px;
      box-sizing: border-box;
      max-height: none;
    }
    /* ensure the inner cards don't cause page body scroll when interacting with market lists */
    #market-items-grid::-webkit-scrollbar, #market-owned-grid::-webkit-scrollbar { width: 8px; height: 8px; }
    #market-items-grid::-webkit-scrollbar-thumb, #market-owned-grid::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.08); border-radius: 6px; }
    /* Compact header pills on small screens */
    @media (max-width: 640px){
      #market-screen .header-right{gap:.4rem; display:flex; align-items:center}
      #market-screen .money-pill{padding:.35rem .6rem;font-size:.95rem}
      #market-screen #stars-display-market{padding:.35rem .6rem;font-size:.95rem}
      #market-screen header .title-wrap{flex:1; text-align:center; margin:0 56px;} /* space for back and pills */
    }
    /* Subtle polish for gameplay to match new style */
    #order-display{max-width:14rem}
  </style>
</head>
<body class="no-select">
  <!-- Loading Screen -->
  <div id="loading-screen" class="fixed inset-0 flex flex-col items-center justify-center">
    <i class="fas fa-spinner fa-spin text-6xl text-purple-600 mb-4"></i>
    <h1 class="text-2xl font-bold font-black" style="color:var(--text-primary)">Carregando Cozinha...</h1>
  </div>

  <div id="app" class="w-full h-full flex items-center justify-center">
    <!-- conteúdo gerado dinamicamente por app.js -->
  </div>

  <!-- App modules -->
  <script type="module" src="./data.js"></script>
  <script type="module" src="./audio.js"></script>
  <script type="module" src="./ui.js"></script>
  <script type="module" src="./app.js"></script>

  <!-- Registro do Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => {
            console.log('Service Worker registrado:', reg.scope);
            // Atualização automática e estável
            reg.addEventListener('updatefound', () => {
              const newSW = reg.installing;
              if (!newSW) return;
              newSW.addEventListener('statechange', () => {
                if (newSW.state === 'installed' && navigator.serviceWorker.controller) {
                  // Pede para ativar imediatamente a nova versão
                  reg.waiting && reg.waiting.postMessage({ type: 'SKIP_WAITING' });
                }
              });
            });
            // Quando o SW ativar, recarrega em background para usar a nova versão
            navigator.serviceWorker.addEventListener('controllerchange', () => {
              // Adia um pouco para evitar piscar a tela em certas plataformas
              setTimeout(() => location.reload(), 100);
            });
          })
          .catch(err => console.warn('Falha ao registrar SW:', err));
      });
    }
  </script>
</body>
</html>
